source("~/Desktop/Evolution/Tasks/Task_01/task01.r")
source("~/Desktop/Evolution/Tasks/Task_01/task01.r")
read.delim(Saimaa_ringed_seal_microsat.txt)
read.delim(Saimaa_ringed_seal_microsat.txt, header=TRUE, sep="\t", dec=".", ...)
read.delim(Saimaa_ringed_seal_microsat.txt, header=TRUE, sep="\t", dec=".")
setwd("/Users/taylorsexton/Desktop/Evolution/Tasks/Task_08")
library(phytools)
#Questions 1-3
trees <- list()
births <- c()
Fractions <- c()
random <- c()
random2 <- c()
treelist <- c()
for (i in 1:100){
births[i]<- runif(1)
Fractions[i]<- runif(1)
trees[[i]] <- pbtree(n=100, b=births[i], d=births[i]*Fractions[i])
random[[i]] <- births[i]
random2[[i]] <- (Fractions[i])
treelist[[i]] <- mean(trees[[i]]$edge.length)
}
plot(trees[[i]])
pdf('Trees.pdf')
dev.off()
sapply(trees,Ntip)
tips <- log(sapply(trees, Ntip))
random3 <- unlist(random)
head(tips)
plot(tips, xlab= "Log of Tips", ylab="Net Diversification")
pdf("Log Tips & Diversification Q4.pdf")
cor(tips, random3)
random4 <- unlist(random2)
treelist2 <- unlist(treelist)
plot(treelist2, random3, ylab="Speciation Rate", xlab="Average Branch Length", pch=3)
dev.off()
dev.off()
cor(tips, random3)
random4 <- unlist(random2)
treelist2 <- unlist(treelist)
plot(treelist2, random3, ylab="Speciation Rate", xlab="Average Branch Length", pch=3)
pdf("Speciation Rate & Average Branch Length.pdf")
dev.off()
dev.off()
cor(treelist2, random4)
Tree <- trees[[which.max(tips)]]
pdf("Tree.pdf")
plot(Tree)
rates <- c()
traits <- list()
meantraits <- c()
vartraits <- c()
for( i in 1:100){
rates[i]<- runif(1)
traits[[i]]<- fastBM(tree=Tree, sig2=rates[i])
meantraits[[i]] <- mean(traits[[i]])
vartraits[[i]]<- var(traits[[i]])
}
cor(treelist2, random4)
Tree <- trees[[which.max(tips)]]
plot(Tree)
pdf("Tree.pdf")
rates <- c()
traits <- list()
meantraits <- c()
vartraits <- c()
for( i in 1:100){
rates[i]<- runif(1)
traits[[i]]<- fastBM(tree=Tree, sig2=rates[i])
meantraits[[i]] <- mean(traits[[i]])
vartraits[[i]]<- var(traits[[i]])
}
#Question 8
meantraits <- unlist(meantraits)
plot(meantraits)
dev.off()
dev.off()
cor(treelist2, random4)
Tree <- trees[[which.max(tips)]]
plot(Tree)
pdf("Tree.pdf")
dev.off()
dev.off()
rates <- c()
traits <- list()
meantraits <- c()
vartraits <- c()
for( i in 1:100){
rates[i]<- runif(1)
traits[[i]]<- fastBM(tree=Tree, sig2=rates[i])
meantraits[[i]] <- mean(traits[[i]])
vartraits[[i]]<- var(traits[[i]])
}
meantraits <- unlist(meantraits)
plot(meantraits)
pdf("Rates of Meantraits.pdf")
dev.off()
dev.off()
cor(meantraits, rates)
vartraits <- unlist(vartraits)
plot(vartraits, rates)
pdf("Rate of Vartraits")
dev.off()
dev.off()
cor(vartraits, rates)
plot(traits[[1]], traits[[2]])
dev.off()
cor(traits[[1]], traits[[2]])
traitMat <- cbind(traits[[1]], traits[[4]])
#Question 10
plot(traits[[1]], traits[[2]])
pdf("08_plot.pdf")
dev.off()
cor(traits[[1]], traits[[2]])
#The correlation is -0.3635708
traitMat <- cbind(traits[[1]], traits[[4]])
dev.off()
#Extra Credit
phylomorphospace(Tree, traitMat, xlab="Trait 1", ylab= "Trait 2")
pdf("08_ec.pdf")
dev.off()
dev.off()
#Question 4
#
plot(trees[[i]])
dev.off()
sapply(trees,Ntip)
tips <- log(sapply(trees, Ntip))
random3 <- unlist(random)
head(tips)
plot(tips, xlab= "Log of Tips", ylab="Net Diversification")
dev.off()
#Question 4
# The net diversification seems to be random in the plot made.
div_rate <- sapply(trees, function(x) length(x$tip.label))
log_tips <- log(sapply(trees, function(x) length(x$tip.label)))
library(ggplot2)
ggplot(data = data.frame(div_rate, log_tips), aes(x= log_tips, y= div_rate))+
geom_point()+
xlab("Log Number of Tips")+
ylab("Net Diversification")+
ggtitle("Net Diversification vs. Log Number of Tips")
pdf("Log Tips & Diversification Q4.pdf")
dev.off()
dev.off()
#Question 5
#
speciation_rate <- sapply(births, function(x)x)
avg_branchlength <- sapply(trees, function(x) mean(x$edge.length, na.rm=TRUE))
ggplot(data = dataframe(speciation_rate, avg_branchlength), aes(x= speciation_rate, y=avg_branchlength))+
geom_point()+
xlab("Speciation Rate")+
ylab("Average Branch Length")+
ggtitle("Speciation Rate vs. Average Branch Length")
ggplot(data = data.frame(speciation_rate, avg_branchlength), aes(x= speciation_rate, y=avg_branchlength))+
geom_point()+
xlab("Speciation Rate")+
ylab("Average Branch Length")+
ggtitle("Speciation Rate vs. Average Branch Length")
pdf("Speciation Rate vs. Average Branch Length")
dev.off()
dev.off()
#Question 6
#
cor(speciation_rate, avg_branchlength)
#Question 7
#
largest_tree <- trees[[which.max(sapply(trees, length))]]
Tree <- largest_tree
plot(Tree)
#Question 7
#
largest_tree <- trees[[which.max(sapply(trees, length))]]
Tree <- largest_tree
plot(Tree)
pdf("Tree.pdf")
dev.off()
dev.off()
rates <- c()
traits <- list()
for( i in 1:100){
rates[i]<- runif(1)
traits[[i]]<- fastBM(tree=Tree, sig2=rates[i])
}
#Question 8
mean_traits <- sapply(traits, mean)
cor(mean_traits, rates)
# The correlation is -0.08890789
plot(meantraits)
pdf("Rates of Meantraits.pdf")
dev.off()
dev.off()
# The correlation is -0.08890789
plot(rates, mean_traits, xlab="Rates", ylab="Mean Trait")
pdf("Rates of Meantraits.pdf")
dev.off()
dev.off()
# The correlation is -0.08890789
plot(rates, mean_traits, xlab="Rates", ylab="Mean Trait")
#Question 9
var_traits <- sapply(traits, var)
cor(var_traits, rates)
# The correlation is 0.7809559 which means there is a strong positive correlation.
plot(rates, var_traits, xlab="Rates", ylab="Variance of Traits")
pdf("Rate of Vartraits.pdf")
dev.off()
dev.off()
#Question 10
cor(traits[[1]], traits[[2]])
# The correlation is 0.03994475 which means there is a weak correlation.
plot(traits[[1]], traits[[2]])
# The correlation is 0.03994475 which means there is a weak correlation.
traitMat <- cbind(traits[[1]], traits[[4]])
plot(traitMat)
pdf("08_plot.pdf")
dev.off()
dev.off()
#Extra Credit
phylomorphospace(Tree, traitMat, xlab="Trait 1", ylab= "Trait 2")
pdf("08_ec.pdf")
dev.off()
dev.off()
#The correlation is 0.03994475 which means there is a weak correlation.
traitMat <- cbind(traits[[1]], traits[[4]])
plot(traitMat)
dev.off()
#Extra Credit
phylomorphospace(Tree, traitMat, xlab="Trait 1", ylab= "Trait 2")
