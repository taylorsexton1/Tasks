source("~/Desktop/Evolution/Tasks/Task_01/task01.r")
source("~/Desktop/Evolution/Tasks/Task_01/task01.r")
read.delim(Saimaa_ringed_seal_microsat.txt)
read.delim(Saimaa_ringed_seal_microsat.txt, header=TRUE, sep="\t", dec=".", ...)
read.delim(Saimaa_ringed_seal_microsat.txt, header=TRUE, sep="\t", dec=".")
setwd("/Users/taylorsexton/Desktop/Evolution/Tasks/Task_08")
library(phytools)
#Questions 1-3
trees <- list()
births <- c()
Fractions <- c()
random <- c()
random2 <- c()
treelist <- c()
for (i in 1:100){
births[i]<- runif(1)
Fractions[i]<- runif(1)
trees[[i]] <- pbtree(n=100, b=births[i], d=births[i]*Fractions[i])
random[[i]] <- births[i]
random2[[i]] <- (Fractions[i])
treelist[[i]] <- mean(trees[[i]]$edge.length)
}
plot(trees[[i]])
pdf('Trees.pdf')
dev.off()
sapply(trees,Ntip)
tips <- log(sapply(trees, Ntip))
random3 <- unlist(random)
head(tips)
plot(tips, xlab= "Log of Tips", ylab="Net Diversification")
pdf("Log Tips & Diversification Q4.pdf")
cor(tips, random3)
random4 <- unlist(random2)
treelist2 <- unlist(treelist)
plot(treelist2, random3, ylab="Speciation Rate", xlab="Average Branch Length", pch=3)
dev.off()
dev.off()
cor(tips, random3)
random4 <- unlist(random2)
treelist2 <- unlist(treelist)
plot(treelist2, random3, ylab="Speciation Rate", xlab="Average Branch Length", pch=3)
pdf("Speciation Rate & Average Branch Length.pdf")
dev.off()
dev.off()
cor(treelist2, random4)
Tree <- trees[[which.max(tips)]]
pdf("Tree.pdf")
plot(Tree)
rates <- c()
traits <- list()
meantraits <- c()
vartraits <- c()
for( i in 1:100){
rates[i]<- runif(1)
traits[[i]]<- fastBM(tree=Tree, sig2=rates[i])
meantraits[[i]] <- mean(traits[[i]])
vartraits[[i]]<- var(traits[[i]])
}
cor(treelist2, random4)
Tree <- trees[[which.max(tips)]]
plot(Tree)
pdf("Tree.pdf")
rates <- c()
traits <- list()
meantraits <- c()
vartraits <- c()
for( i in 1:100){
rates[i]<- runif(1)
traits[[i]]<- fastBM(tree=Tree, sig2=rates[i])
meantraits[[i]] <- mean(traits[[i]])
vartraits[[i]]<- var(traits[[i]])
}
#Question 8
meantraits <- unlist(meantraits)
plot(meantraits)
dev.off()
dev.off()
cor(treelist2, random4)
Tree <- trees[[which.max(tips)]]
plot(Tree)
pdf("Tree.pdf")
dev.off()
dev.off()
rates <- c()
traits <- list()
meantraits <- c()
vartraits <- c()
for( i in 1:100){
rates[i]<- runif(1)
traits[[i]]<- fastBM(tree=Tree, sig2=rates[i])
meantraits[[i]] <- mean(traits[[i]])
vartraits[[i]]<- var(traits[[i]])
}
meantraits <- unlist(meantraits)
plot(meantraits)
pdf("Rates of Meantraits.pdf")
dev.off()
dev.off()
cor(meantraits, rates)
vartraits <- unlist(vartraits)
plot(vartraits, rates)
pdf("Rate of Vartraits")
dev.off()
dev.off()
cor(vartraits, rates)
plot(traits[[1]], traits[[2]])
dev.off()
cor(traits[[1]], traits[[2]])
traitMat <- cbind(traits[[1]], traits[[4]])
#Question 10
plot(traits[[1]], traits[[2]])
pdf("08_plot.pdf")
dev.off()
cor(traits[[1]], traits[[2]])
#The correlation is -0.3635708
traitMat <- cbind(traits[[1]], traits[[4]])
dev.off()
#Extra Credit
phylomorphospace(Tree, traitMat, xlab="Trait 1", ylab= "Trait 2")
pdf("08_ec.pdf")
dev.off()
dev.off()
#Question 4
#
plot(trees[[i]])
dev.off()
sapply(trees,Ntip)
tips <- log(sapply(trees, Ntip))
random3 <- unlist(random)
head(tips)
plot(tips, xlab= "Log of Tips", ylab="Net Diversification")
dev.off()
#Question 4
# The net diversification seems to be random in the plot made.
div_rate <- sapply(trees, function(x) length(x$tip.label))
log_tips <- log(sapply(trees, function(x) length(x$tip.label)))
library(ggplot2)
ggplot(data = data.frame(div_rate, log_tips), aes(x= log_tips, y= div_rate))+
geom_point()+
xlab("Log Number of Tips")+
ylab("Net Diversification")+
ggtitle("Net Diversification vs. Log Number of Tips")
pdf("Log Tips & Diversification Q4.pdf")
dev.off()
dev.off()
#Question 5
#
speciation_rate <- sapply(births, function(x)x)
avg_branchlength <- sapply(trees, function(x) mean(x$edge.length, na.rm=TRUE))
ggplot(data = dataframe(speciation_rate, avg_branchlength), aes(x= speciation_rate, y=avg_branchlength))+
geom_point()+
xlab("Speciation Rate")+
ylab("Average Branch Length")+
ggtitle("Speciation Rate vs. Average Branch Length")
ggplot(data = data.frame(speciation_rate, avg_branchlength), aes(x= speciation_rate, y=avg_branchlength))+
geom_point()+
xlab("Speciation Rate")+
ylab("Average Branch Length")+
ggtitle("Speciation Rate vs. Average Branch Length")
pdf("Speciation Rate vs. Average Branch Length")
dev.off()
dev.off()
#Question 6
#
cor(speciation_rate, avg_branchlength)
#Question 7
#
largest_tree <- trees[[which.max(sapply(trees, length))]]
Tree <- largest_tree
plot(Tree)
#Question 7
#
largest_tree <- trees[[which.max(sapply(trees, length))]]
Tree <- largest_tree
plot(Tree)
pdf("Tree.pdf")
dev.off()
dev.off()
rates <- c()
traits <- list()
for( i in 1:100){
rates[i]<- runif(1)
traits[[i]]<- fastBM(tree=Tree, sig2=rates[i])
}
#Question 8
mean_traits <- sapply(traits, mean)
cor(mean_traits, rates)
# The correlation is -0.08890789
plot(meantraits)
pdf("Rates of Meantraits.pdf")
dev.off()
dev.off()
# The correlation is -0.08890789
plot(rates, mean_traits, xlab="Rates", ylab="Mean Trait")
pdf("Rates of Meantraits.pdf")
dev.off()
dev.off()
# The correlation is -0.08890789
plot(rates, mean_traits, xlab="Rates", ylab="Mean Trait")
#Question 9
var_traits <- sapply(traits, var)
cor(var_traits, rates)
# The correlation is 0.7809559 which means there is a strong positive correlation.
plot(rates, var_traits, xlab="Rates", ylab="Variance of Traits")
pdf("Rate of Vartraits.pdf")
dev.off()
dev.off()
#Question 10
cor(traits[[1]], traits[[2]])
# The correlation is 0.03994475 which means there is a weak correlation.
plot(traits[[1]], traits[[2]])
# The correlation is 0.03994475 which means there is a weak correlation.
traitMat <- cbind(traits[[1]], traits[[4]])
plot(traitMat)
pdf("08_plot.pdf")
dev.off()
dev.off()
#Extra Credit
phylomorphospace(Tree, traitMat, xlab="Trait 1", ylab= "Trait 2")
pdf("08_ec.pdf")
dev.off()
dev.off()
#The correlation is 0.03994475 which means there is a weak correlation.
traitMat <- cbind(traits[[1]], traits[[4]])
plot(traitMat)
dev.off()
#Extra Credit
phylomorphospace(Tree, traitMat, xlab="Trait 1", ylab= "Trait 2")
library(phytools)
#Questions 1-3
trees <- list()
births <- c()
Fractions <- c()
random <- c()
random2 <- c()
treelist <- c()
for (i in 1:100){
births[i]<- runif(1)
Fractions[i]<- runif(1)
trees[[i]] <- pbtree(n=100, b=births[i], d=births[i]*Fractions[i])
random[[i]] <- births[i]
random2[[i]] <- (Fractions[i])
treelist[[i]] <- mean(trees[[i]]$edge.length)
}
#Question 4
# The net diversification increases as the log of the number of tips increases. The increase is an exponential curve.
div_rate <- sapply(trees, function(x) length(x$tip.label))
log_tips <- log(sapply(trees, function(x) length(x$tip.label)))
library(ggplot2)
ggplot(data = data.frame(div_rate, log_tips), aes(x= log_tips, y= div_rate))+
geom_point()+
xlab("Log Number of Tips")+
ylab("Net Diversification")+
ggtitle("Net Diversification vs. Log Number of Tips")
dev.off()
#Question 5
#This graph shows a slight decrease towards 0 in branch length as the speciation rate approaches 1.
speciation_rate <- sapply(births, function(x)x)
avg_branchlength <- sapply(trees, function(x) mean(x$edge.length, na.rm=TRUE))
ggplot(data = data.frame(speciation_rate, avg_branchlength), aes(x= speciation_rate, y=avg_branchlength))+
geom_point()+
xlab("Speciation Rate")+
ylab("Average Branch Length")+
ggtitle("Speciation Rate vs. Average Branch Length")
dev.off()
#Question 6
# The correlation between speciation rate and average branch length is -0.1702541 which means there is a weak negative relationship between the two variables.
cor(speciation_rate, avg_branchlength)
#Question 7
largest_tree <- trees[[which.max(sapply(trees, length))]]
Tree <- largest_tree
plot(Tree)
dev.off()
rates <- c()
traits <- list()
for( i in 1:100){
rates[i]<- runif(1)
traits[[i]]<- fastBM(tree=Tree, sig2=rates[i])
}
#Question 8
mean_traits <- sapply(traits, mean)
cor(mean_traits, rates)
#The correlation is -0.08890789 which means there is a weak negative correlation. The graph shows a negative correlation, but it seems more scattered.
plot(rates, mean_traits, xlab="Rates", ylab="Mean Trait")
dev.off()
#Question 9
var_traits <- sapply(traits, var)
cor(var_traits, rates)
# The correlation is 0.7809559 which means there is a strong positive correlation. The graph also shows a positive correlation.
plot(rates, var_traits, xlab="Rates", ylab="Variance of Traits")
dev.off()
#Question 10
cor(traits[[1]], traits[[2]])
#The correlation is 0.03994475 which means there is a weak correlation.
traitMat <- cbind(traits[[1]], traits[[4]])
plot(traitMat)
library(diversitree)
install.packages(diversitree)
install.packages("diversitree")
library(diversitree)
transition_0tol<- 0.1
transition_0to1<- 0.1
transition_1to0<- 0.1
speciation_0<- 0.2
extinction_0<- 0.2
extinction_0<- 0.1
speciation_1<- 0.2
extinction_1<- 0.1
maxN<- 1e3
maxT<- 50
Pars<- c(speciation_0, speciation_1, extinction_0, extinction_1, transition_0to1, transition_1to0)
simTree<- tree.bisse(Pars, max.taxa= maxN, max.t=maxT)
str(simTree)
transition_0to1<- 0.1
transition_1to0<- 0.1
speciation_0<- 0.2
extinction_0<- 0.1
speciation_1<- 0.2
extinction_1<- 0.1
maxN<- 1e3
maxT<- 50
Pars<- c(speciation_0, speciation_1, extinction_0, extinction_1, transition_0to1, transition_1to0)
simTree<- tree.bisse(Pars, max.taxa= maxN, max.t=maxT)
str(simTree)
stateTable <- table(simTree$tip.state)
stateTable / sum(stateTable)
# Create an empty data frame to store the results
results <- data.frame()
# Run the simulations
for (p in p_values) {
for (lambda in lambda_values) {
freqs <- c()
for (sim in 1:num_sims) {
# Simulate a single tree
num_states <- c(1, rep(2, num_gens-1))
for (gen in 2:num_gens) {
new_num_states <- c()
for (i in 1:length(num_states)) {
if (num_states[i] == 1) {
num_offspring <- rpois(1, lambda)
offspring_states <- sample(c(1, 2), num_offspring, replace = TRUE, prob = c(p, 1-p))
new_num_states <- c(new_num_states, offspring_states)
} else {
new_num_states <- c(new_num_states, 2)
}
}
num_states <- new_num_states
}
freqs <- c(freqs, sum(num_states == 1)/num_gens)
}
# Calculate the mean and standard deviation of the frequency of state 1
mean_freq <- mean(freqs)
sd_freq <- sd(freqs)
# Add the results to the data frame
results <- rbind(results, data.frame(p = p, lambda = lambda, mean_freq = mean_freq, sd_freq = sd_freq))
}
}
